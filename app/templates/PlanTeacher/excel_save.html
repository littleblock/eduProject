{% extends "PlanTeacher/layout.html" %}
 
{% block title %}导入excel文件{% endblock %}
{% block content %}
<script>
        var xhr;
        //上传文件方法
        function UpladFile() {
            var fileObj = document.getElementById("file").files[0]; // js 获取文件对象
            var url = "{{url_for('home.excel_plan')}}"; // 接收上传文件的后台地址
            var a = "{{ids.stu_id}}";
            var b = "{{ids.teach_id}}";
            var form = new FormData(); // FormData 对象
                form.append("file", fileObj); // 文件对象
                form.append("stu",a);
                form.append("teach",b);
                xhr = new XMLHttpRequest();  // XMLHttpRequest 对象
                xhr.open("post", url, true); //post方式，url为服务器请求地址，true 该参数规定请求是否异步处理。
                xhr.send(form); //开始上传，发送form数据
            }
</script>
  <h1>导入excel文件</h1>
  <input type="file" id="file" name="myfile"/>
  <input type="button" onclick="UpladFile()" value="上传" />
{% endblock %}